<html>
<head>
<style> * { margin: 0px; padding: 0px; } </style>
<script src="draw.js"></script>
</head>
<body>
<script>
function PriorityQueue(){
    this.maxDist = 0;
    this.min     = Infinity;
    this.size    = 0;
    this.keys    = [[]];
    this.vals    = [[]];
};
PriorityQueue.prototype.grow = function(newMaxDist){
    for (var i=this.maxDist+1; i<=newMaxDist; ++i){
        this.keys[i] = [];
        this.vals[i] = [];
    };
    this.maxDist = newMaxDist;
};
PriorityQueue.prototype.add = function(key,val){
    if (key > this.maxDist) 
        this.grow(key);
    this.keys[key].push(key);
    this.vals[key].push(val);
    if (key < this.min) 
        this.min = key; 
    ++this.size;
};
PriorityQueue.prototype.get = function(){
    if (this.size === 0) return 0;
    var minKey = this.keys[this.min].pop();
    var minVal = this.vals[this.min].pop();
    while (this.min < this.keys.length && this.keys[this.min].length === 0)
        ++this.min;
    if (this.min === this.keys.length)
        this.min = Infinity;
    --this.size;
    return minVal;
};

var draw = new Draw({w:window.innerWidth, h:window.innerHeight});
draw.canvas.style.border = "1px solid black";
document.body.appendChild(draw.canvas);

var pq = new PriorityQueue();

function post(msg){ return function(){ message = msg; }; };
function add(a,b){ return function(){ pq.add(a,b); post("adicionando vértice "+b+" com peso "+a+"")(); }; };
function get(){ return function(){ var x = pq.get(); post("removendo vértice "+x)(); }; };

function render(pq){
    var w = 32;
    var h = 32;
    var l = pq.keys.length;
    var hl = l/2;
    draw.clear();
    draw.text({x:0,y:-(hl*h)-32,text:message});
    for (var j=0; j<l; ++j){
        var y = (j-hl+0.5)*h;
        draw.rect({x:0,y:y,w:w-2,h:h-2,fill:"#EEEEEE"});
        draw.text({x:-32,y:y,text:j,fill:"black"});
        for (var i=0; i<pq.vals[j].length; ++i){
            var x = i*w;
            draw.rect({x:x,y:y,w:w-2,h:h-2,fill:j === pq.min ? "#FFAAAA" : "#AAAAFF"});
            draw.text({x:x,y:y,text:pq.vals[j][i],fill:"black"});
        };
    };
};

var t = 0;
script = {
    0: post("Estrutura usada: array de arrays dinâmicos."),
    60: post("Linhas = pesos, colunas = vértices."),
    120: add(2,1),
    200: add(7,2),
    280: add(4,3),
    320: add(1,4),
    340: add(5,5),
    380: add(1,6),
    400: add(2,9),
    420: add(6,8),
    460: add(2,9),
    480: add(4,10),
    500: add(6,11),
    520: add(2,12),
    540: add(1,13),
    560: add(11,14),
    580: add(11,15),
    600: add(12,16),
    620: post("Removemos sempre o último da linha vermelha:"),
    680: get(),
    760: get(),
    840: get(),
    920: get(),
    940: get(),
    960: get(),
    980: get(),
    1000: get(),
    1020: get()
};
setInterval(function(){ 
    if (script[t]) 
        script[t](); 
    render(pq);
    ++t;
},60);


</script>
</body>
</html>
